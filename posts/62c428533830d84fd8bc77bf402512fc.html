<!DOCTYPE html><html lang=zh><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><title>.ap_ 文件的作用 - linjiang</title><meta name=description content=linjiang&#39;blog><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Merriweather+Sans:400,300,700" type=text/css><link rel=stylesheet href=/style.css></head><body><header><h1><a href=/ >linjiang</a></h1><ul class=list-inline><li><a href=/ ><span>Home</span></a></li><li><a href=/about.html><span>About</span></a></li><li><a href=https://github.com/whataa target=_blank><span>GitHub</span></a></li></ul></header><div class=content><article class="blog-post post"><h2>.ap_ 文件的作用</h2><p class=date>2020-04-20</p><div class=post-content><ul><li><p>AAPT2 将AAPT 对资源的编译拆分细化为了 <code>compile</code> 和 <code>link</code> 两个步骤，以更好地提升编译速度（增量编译）。</p></li><li><p>其中 link 的结果除了生成 <code>R.java</code> 外，还生成了 <code>.ap_</code> 产物（本质上是zip），包含 <code>manifest</code> 清单、所有资源文件以及资源索引表<code>arsc</code>。</p></li><li><p>当执行 package-task 生成 .apk 时并不是解压.ap_文件得到相关资源再与dex重新压缩，而是以 <strong>copy zip entry</strong> 的形式直接拷贝到最终的apk文件。也就是说，.ap_ 文件中各个entry的压缩效果与apk中一致。</p></li></ul></div></article><script src=https://giscus.app/client.js data-repo=whataa/whataa.github.io data-repo-id="MDEwOlJlcG9zaXRvcnk1NDY1NzI1MA==" data-category=Announcements data-category-id=DIC_kwDOA0IA4s4CtJJY data-mapping=title data-strict=0 data-reactions-enabled=0 data-emit-metadata=0 data-input-position=top data-theme=light data-lang=zh-CN data-loading=lazy crossorigin=anonymous async></script><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/github-dark.min.css><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js></script><script>hljs.highlightAll()</script></div></body></html>